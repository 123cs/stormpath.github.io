

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Access Control &mdash; Stormpath Java Servlet Plugin 1.0.RC4.2 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
        <link rel="author" title="About these documents"
              href="about.html"/>
    <link rel="top" title="Stormpath Java Servlet Plugin 1.0.RC4.2 documentation" href="index.html"/>
        <link rel="next" title="Internationalization (i18n)" href="i18n.html"/>
        <link rel="prev" title="Request Context" href="request.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> Stormpath Java Servlet Plugin</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="about.html#what-is-stormpath">What is Stormpath?</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html#what-is-the-stormpath-java-servlet-plugin">What is the Stormpath Java Servlet Plugin?</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html#who-should-use-stormpath">Who should use Stormpath?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#get-an-api-key">Get an API Key</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#add-the-stormpath-java-servlet-plugin">Add the Stormpath Java Servlet Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#try-it">Try it!</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="config.html#no-config">No Config?</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#web-xml">web.xml</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#stormpath-properties">stormpath.properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#sdk-client">SDK Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#stormpath-application">Stormpath Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#filters">Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#uris">URIs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="registration.html">Registration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="registration.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#uri">URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#next-uri">Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#form-fields">Form Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#i18n">i18n</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#email-verification">Email Verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="registration.html#events">Events</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="login.html">Login</a><ul>
<li class="toctree-l2"><a class="reference internal" href="login.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#security-notice">Security Notice</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#uri">URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#next-uri">Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#i18n">i18n</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#events">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="login.html#authentication-state">Authentication State</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="forgot-password.html">Forgot Password</a><ul>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#configure-the-workflow">Configure the Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#try-it">Try it!</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#forgot-uri">Forgot URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#forgot-next-uri">Forgot Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#change-password-uri">Change Password URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#change-password-next-uri">Change Password Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="forgot-password.html#i18n">i18n</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="logout.html">Logout</a><ul>
<li class="toctree-l2"><a class="reference internal" href="logout.html#uri">URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="logout.html#next-uri">Next URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="logout.html#events">Events</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="http-request-authentication.html">HTTP Request Authentication</a><ul>
<li class="toctree-l2"><a class="reference internal" href="http-request-authentication.html#http-basic-authentication">HTTP Basic Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="http-request-authentication.html#token-authentication">Token Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="http-request-authentication.html#api-key-authentication">API Key Authentication</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="request.html">Request Context</a><ul>
<li class="toctree-l2"><a class="reference internal" href="request.html#current-user-account">Current User Account</a></li>
<li class="toctree-l2"><a class="reference internal" href="request.html#stormpath-application">Stormpath Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="request.html#stormpath-sdk-client">Stormpath SDK Client</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Access Control</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#authentication">Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="#authorization">Authorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#exclusions">Exclusions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="i18n.html">Internationalization (i18n)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="i18n.html#languages">Languages</a></li>
<li class="toctree-l2"><a class="reference internal" href="i18n.html#request-locale">Request Locale</a></li>
<li class="toctree-l2"><a class="reference internal" href="i18n.html#jsp-tag-library">JSP Tag Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="i18n.html#i18n-properties">i18n.properties</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="events.html">Events</a><ul>
<li class="toctree-l2"><a class="reference internal" href="events.html#requesteventlistener">RequestEventListener</a></li>
<li class="toctree-l2"><a class="reference internal" href="events.html#id2">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="events.html#listener-best-practices">Listener Best Practices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="caching.html">Caching</a><ul>
<li class="toctree-l2"><a class="reference internal" href="caching.html#in-process-cache">In-Process Cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="caching.html#shared-cache">Shared Cache</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="views.html">Custom Views</a><ul>
<li class="toctree-l2"><a class="reference internal" href="views.html#jsp-views">JSP Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#css">CSS</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#internationalization-i18n">Internationalization (i18n)</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#change-a-default-view">Change a Default View</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html#view-template">View Template</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">Appendix</a><ul>
<li class="toctree-l2"><a class="reference internal" href="appendix/default-stormpath-properties.html">A: default.stormpath.properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix/i18n-properties.html">B: i18n.properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix/stormpath-css.html">C: stormpath.css</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Stormpath Java Servlet Plugin</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Access Control</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/access-control.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="access-control">
<span id="id1"></span><h1>Access Control<a class="headerlink" href="#access-control" title="Permalink to this headline">¶</a></h1>
<p>The Stormpath Java Servlet Plugin allows you to easily control which of your web application&#8217;s URI paths a user is allowed to access based on configurable rules.</p>
<p>The rules are implemented via simple Servlet <a class="reference internal" href="config.html#filters"><em>filters</em></a> and <a class="reference internal" href="config.html#uris"><em>configurable filter chains</em></a>, but in a simpler, easier to read, much more flexible, and more succinct definition format than you might be used to with <tt class="docutils literal"><span class="pre">web.xml</span></tt> configuration.</p>
<p>It works as follows:</p>
<ul>
<li><p class="first">You can define any number of servlet filter implementation that represents a single control rule, for example, the current requestor must be a known user, or the they must be authenticated, or they must belong to a particular group, etc.  The plugin comes with a number of useful ones ready to go out of the box.</p>
</li>
<li><p class="first">For any URI path that a user might access, you can specify one or more of these control rules (filters).  If all of the control filter conditions pass - that is, each specified filter determines that the current request is allowed - the filters allow the request to continue to the final destination, presumably a Servlet or an MVC controller in your favorite web framework.</p>
<p>If the access control condition is not satisfied, any filter is allowed to do what it needs: for example, redirect the user to a different location or send back a particular 4XX status code.  This provides a very flexible mechanism to build up rule chains as necessary based on your application requirements.</p>
</li>
</ul>
<p>See the configuration chapter to see how to define the available access control <a class="reference internal" href="config.html#filters"><em>filters</em></a> and <a class="reference internal" href="config.html#uris"><em>URI-specific filter chains</em></a></p>
<p>Next, we&#8217;ll see how uri patterns and filters allow you to define authentication and authorization rules for your web application.</p>
<div class="section" id="authentication">
<h2>Authentication<a class="headerlink" href="#authentication" title="Permalink to this headline">¶</a></h2>
<p>If you need to ensure a user is authenticated before accessing a particular URI path, you can specify the <tt class="docutils literal"><span class="pre">authc</span></tt> filter for a particular request.  For example, assume that only authenticated users are allowed to access the account dashboard located at <tt class="docutils literal"><span class="pre">/account/dashboard</span></tt>.  We could create a uri path definition:</p>
<div class="highlight-properties"><div class="highlight"><pre><span class="na">stormpath.web.uris./account/dashboard</span> <span class="o">=</span> <span class="s">authc</span>
</pre></div>
</div>
<p>This line indicates:</p>
<ul class="simple">
<li>Is the user associated with the request to <tt class="docutils literal"><span class="pre">/account/dashboard</span></tt> authenticated?<ul>
<li>If yes: allow the request to continue, where it will be handled by a Servlet or MVC controller.</li>
<li>If no: Was the request made by a browser (i.e. the requester prefers HTML or XHTML content based on the <tt class="docutils literal"><span class="pre">Accept</span></tt> header) ?<ul>
<li>If yes, HTML content is preferred, redirect the request to the <a class="reference internal" href="login.html#login"><em>Login</em></a> view.</li>
<li>If no, HTML content is not preferred, send an HTTP authentication challenge response that indicates the types of HTTP authentication that are supported.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>As you can see, this authentication assertion behavior supports both &#8216;normal&#8217; browser-initiated requests as well as HTTP client libraries.</p>
<div class="topic">
<p class="topic-title first">Security: Require Authentication By Default</p>
<p>For many web applications, the safest security policy is to always require authentication for any URL that is not explicitly intended for anonymous users.  This is easily achieved by using a &#8216;catch all&#8217; rule at the very bottom of your URI filter chains definitions:</p>
<div class="highlight-properties"><div class="highlight"><pre><span class="c"># other stormpath.web.uris.* properties above here</span>

<span class="c"># &#39;catch all&#39;: require authentication for anything not explicitly allowed by anonymous users:</span>
<span class="na">stormpath.web.uris./**</span> <span class="o">=</span> <span class="s">authc</span>
</pre></div>
</div>
</div>
<div class="section" id="unauthenticatedhandler">
<h3>UnauthenticatedHandler<a class="headerlink" href="#unauthenticatedhandler" title="Permalink to this headline">¶</a></h3>
<p>If the above logic does not meet your needs, you can implement the behavior you want to be executed if it is determined that the requester is not authenticated by specifying the <tt class="docutils literal"><span class="pre">stormpath.web.authc.unauthenticatedHandler</span></tt> configuration property.  The property value must be the name of a fully qualified class name that implements the <tt class="docutils literal"><span class="pre">com.stormpath.sdk.servlet.filter.UnauthenticatedHandler</span></tt> interface.  For example:</p>
<div class="highlight-properties"><div class="highlight"><pre><span class="na">stormpath.web.authc.unauthenticatedHandler</span> <span class="o">=</span>  <span class="s">com.my.impl.MyUnauthenticatedHandler</span>
</pre></div>
</div>
<p>However, this might not be a trivial exercise if you still wish to support both browser and HTTP client semantics.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you want to execute custom behavior as a result of a failed login, it is generally recommended not to implement a custom <tt class="docutils literal"><span class="pre">UnauthenticatedHandler</span></tt> and instead react to <a class="reference internal" href="login.html#login-events"><em>login events</em></a>.  These events are triggered in the event of an authentication by login form or by HTTP headers, so you can react to both scenarios.</p>
</div>
</div>
</div>
<div class="section" id="authorization">
<h2>Authorization<a class="headerlink" href="#authorization" title="Permalink to this headline">¶</a></h2>
<p>TBD</p>
</div>
<div class="section" id="exclusions">
<h2>Exclusions<a class="headerlink" href="#exclusions" title="Permalink to this headline">¶</a></h2>
<p>Sometimes you might want to exclude a particular path or sub path from an authentication or authorization requirement.  One very common example of this is for static assets, such as images, css or javascript files needed to render a UI before a user can log in.</p>
<p>You can specify an exclusion as a new URI path with the <tt class="docutils literal"><span class="pre">anon</span></tt> filter and define it <em>before</em> the URI(s) that require(s) authentication or authorization.  For example, let&#8217;s say all of a web app&#8217;s static assets should always be publicly available under the <tt class="docutils literal"><span class="pre">/assets</span></tt> path (e.g. <tt class="docutils literal"><span class="pre">/assets/images</span></tt>, <tt class="docutils literal"><span class="pre">/assets/css</span></tt>, <tt class="docutils literal"><span class="pre">/assets/js</span></tt>, etc).  You can define an exclusion like this:</p>
<div class="highlight-properties"><div class="highlight"><pre><span class="na">stormpath.web.uris./assets/**</span> <span class="o">=</span> <span class="s">anon</span>

<span class="c"># other uri chains</span>

<span class="c"># everything else not specified requires authentication:</span>
<span class="na">stormpath.web.uris./**</span> <span class="o">=</span> <span class="s">authc</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">anon</span></tt> filter allows any anonymous request to continue to the desired handler without performing access control checks at all.</p>
<p>Because the <tt class="docutils literal"><span class="pre">stormpath.web.uris./assets/**</span></tt> line comes <em>before</em> the <tt class="docutils literal"><span class="pre">stormpath.web.uris./**</span></tt> catch-all line, the first line will match <tt class="docutils literal"><span class="pre">/assets/**</span></tt> requests first and the catch-all assertion will not be executed.  Remember, URI rule chains are matched and executed based on a &#8216;first match wins&#8217; policy.</p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="i18n.html" class="btn btn-neutral float-right" title="Internationalization (i18n)">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="request.html" class="btn btn-neutral" title="Request Context"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Stormpath, Inc..
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0.RC4.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
   
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-29159574-1', 'auto');
    ga('send', 'pageview');
  </script>
  <script type="text/javascript">
    (function(d,s,i,r) {
        if (d.getElementById(i)){return;}
        var n=d.createElement(s),e=d.getElementsByTagName(s)[0];
        n.id=i;n.src='//js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/475298.js';
        e.parentNode.insertBefore(n, e);
    })(document,"script","hs-analytics",300000);
  </script>
  <script type="text/javascript">
    var _kmq = _kmq || [];
    var _kmk = _kmk || '684b854336bd3a6523260ebd991eec06b18b929a';
    function _kms(u){
        setTimeout(function(){
            var d = document, f = d.getElementsByTagName('script')[0],
                    s = d.createElement('script');
            s.type = 'text/javascript'; s.async = true; s.src = u;
            f.parentNode.insertBefore(s, f);
        }, 1);
    }
    _kms('//i.kissmetrics.com/i.js');
    _kms('//doug1izaerwt3.cloudfront.net/' + _kmk + '.1.js');
  </script>
  <script src="//cdn.optimizely.com/js/225847041.js"></script>


</body>
</html>